#!/usr/bin/env bash
set -xe
if command -v rpm-ostree; then
    sudo rpm-ostree upgrade
fi
if command -v dnf; then
    sudo dnf makecache && sudo dnf update -y
fi
# apt --version fails on MacOSX
if apt --version &> /dev/null; then
    command -v apt
    sudo apt update && sudo apt upgrade -y
fi
if command -v snap; then
    sudo snap refresh
fi
if command -v flatpak; then
    sudo dbus-run-session flatpak update -y
    dbus-run-session flatpak update -y
    sudo dbus-run-session flatpak remove --unused
    dbus-run-session flatpak remove --unused
fi
if command -v podman; then
    for container in $(podman ps -a | grep toolbox | awk '{ print $NF }'); do
        toolbox run -c "${container}" sudo dnf update -y
    done
fi
# brew --version fails on linux
if brew --version &> /dev/null; then
    command -v brew
    brew update && brew upgrade
fi
if command -v fwupdmgr; then
    sudo fwupdmgr get-updates
fi
