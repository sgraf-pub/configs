---
  - name: Check rpmfusion-free
    shell: "rpm -q rpmfusion-free-release-{{ ansible_distribution_major_version }}"
    register: result
    ignore_errors: True
    changed_when: "result.rc != 0"
  - name: Install rpmfusion-free
    dnf: name="http://download1.rpmfusion.org/free/fedora/rpmfusion-free-release-{{ ansible_distribution_major_version }}.noarch.rpm" state=present
    when: result is failed

  - name: Install codecs
    dnf: name={{ item }} state=present
    with_items:
    - gstreamer1-plugins-bad-free
    - gstreamer1-plugins-bad-freeworld
    - gstreamer1-plugins-base
    - gstreamer1-plugins-good
    - gstreamer1-plugins-ugly
    - gstreamer1-plugins-ugly-free
    - gstreamer1-libav
    - compat-ffmpeg28

  - name: Install pkgs for VAAPI and VDPAU
    dnf: name={{ item }} state=present
    with_items:
    - gstreamer1-vaapi
    - libva-intel-driver
    - libva-intel-hybrid-driver
    - libva-utils
    - libvdpau
    - vdpauinfo

  - name: Install vulkan drivers
    dnf: name=vulkan state=present

